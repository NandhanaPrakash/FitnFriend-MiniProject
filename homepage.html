<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title</title>

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="https://cdn-icons-png.flaticon.com/512/3756/3756540.png" />

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Quicksand:wght@400;600&display=swap" rel="stylesheet" />

    <!-- A-Frame -->
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>

    <style>
      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        font-family: 'Quicksand', sans-serif;
        overflow: hidden;
      }

      .overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        background: linear-gradient(135deg, #dff6ff, #aee3f9);
        z-index: 2;
        flex-direction: column;
        animation: fadeIn 1.5s ease-in-out;
        background-size: 400% 400%;
        animation: gradient 15s ease infinite;
      }

      @keyframes gradient {
        0% {
          background-position: 0% 50%;
        }
        50% {
          background-position: 100% 50%;
        }
        100% {
          background-position: 0% 50%;
        }
      }

      .form-box {
        background: rgba(255, 255, 255, 0.9);
        padding: 2.5rem;
        border-radius: 25px;
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
        text-align: center;
        animation: popIn 1.2s ease;
        width: 90%;
        max-width: 400px;
      }

      @keyframes popIn {
        from {
          transform: scale(0.9);
          opacity: 0;
        }
        to {
          transform: scale(1);
          opacity: 1;
        }
      }

      .form-box h1 {
        font-family: 'Pacifico', cursive;
        font-size: 2.5rem;
        margin-bottom: 1rem;
        color: #009688;
      }

      .form-box label {
        display: block;
        margin-top: 1rem;
        font-weight: 600;
        color: #333;
      }

      .form-box input,
      .form-box button {
        width: 100%;
        padding: 0.75rem;
        margin-top: 0.5rem;
        font-size: 1rem;
        border-radius: 12px;
        border: 1px solid #ccc;
      }

      .form-box button {
        background-color: #009688;
        color: white;
        border: none;
        transition: 0.3s;
        margin-top: 1.5rem;
        font-weight: bold;
        letter-spacing: 0.5px;
      }

      .form-box button:hover {
        background-color: #00796b;
      }

      .avatar-preview {
        margin-top: 1rem;
        display: flex;
        justify-content: space-around;
        align-items: center;
      }

      .avatar-preview img {
        width: 80px;
        height: 80px;
        object-fit: contain;
        cursor: pointer;
        border: 3px solid transparent;
        border-radius: 50%;
        transition: transform 0.3s, border 0.3s;
      }

      .avatar-preview img:hover {
        transform: scale(1.1);
      }

      .avatar-selected {
        border-color: #009688 !important;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }
    </style>
  </head>

  <body>
    <!-- UI Overlay Form -->
    <div class="overlay" id="home-form">
      <div class="form-box">
        <h1>Welcome to MindSpace ðŸŒ¿</h1>

        <label for="username">Your Name</label>
        <input type="text" id="username" placeholder="e.g. Aria" required />

        <label>Choose Your Avatar</label>
        <div class="avatar-preview">
          <img
            src="https://cdn-icons-png.flaticon.com/512/706/706830.png"
            alt="Male"
            id="male-avatar"
            onclick="selectAvatar('male')"
          />
          <img
            src="https://cdn-icons-png.flaticon.com/512/706/706814.png"
            alt="Female"
            id="female-avatar"
            onclick="selectAvatar('female')"
          />
        </div>

        <button onclick="enterVR()">Enter MindSpace</button>
      </div>
    </div>

    <!-- VR Scene -->
    <a-scene>
      <a-assets>
        <!-- Assets for the avatar -->
        <a-asset-item id="meditator" src="https://raw.githubusercontent.com/iamnithyaramesh/ARVR/main/model.glb"></a-asset-item>

        <audio id="ambient-sound" src="https://www.soundjay.com/button/beep-07.wav" preload="auto"></audio>

        <!-- Background image -->
        <img id="bg-image" src="background2.jpeg" />
      </a-assets>

      <!-- Female Avatar -->
      <a-entity id="avatar" gltf-model="#meditator" position="0 0 -2.5" rotation="0 -18 0" scale="1.2 1.2 1.2"></a-entity>

      <!-- 360Â° Background Sky Image -->
      <a-sky src="background2.jpeg"></a-sky>

      <!-- Ground -->
      <a-plane position="0 0 -3" rotation="-90 0 0" width="50" height="50" color="#B0E0E6" opacity="0.7"></a-plane>

      <!-- Floating particles -->
      <a-entity particle-system="preset: dust; particleCount: 5000; color: #ffffff; size: 0.1; opacity: 0.5; speed: 0.5;" position="0 3 -2"></a-entity>

      <!-- Background sound -->
      <a-sound src="#ambient-sound" position="0 2 -2" autoplay="true" loop="true" volume="0.4"></a-sound>

      <!-- Camera -->
      <a-camera position="0 1.6 0"></a-camera>
    </a-scene>

    <script>
      let selectedAvatar = "";

      function selectAvatar(gender) {
        selectedAvatar = gender;
        document.getElementById("male-avatar").classList.remove("avatar-selected");
        document.getElementById("female-avatar").classList.remove("avatar-selected");

        document.getElementById(gender + "-avatar").classList.add("avatar-selected");
      }

      function enterVR() {
        const username = document.getElementById("username").value.trim();
        if (!username || !selectedAvatar) {
          alert("Please enter your name and choose an avatar.");
          return;
        }

        // Save to localStorage
        localStorage.setItem("mindspace_username", username);
        localStorage.setItem("mindspace_avatar", selectedAvatar);

        // Redirect to VR scene
        window.location.href = "index.html";
      }

      // Load avatar and background in VR scene based on choice
      window.addEventListener("load", () => {
        const avatar = localStorage.getItem("mindspace_avatar");
        const avatarEntity = document.getElementById("avatar");
        
        if (avatar === "male") {
          avatarEntity.setAttribute("gltf-model", "#meditator-male");
        } else {
          avatarEntity.setAttribute("gltf-model", "#meditator");
        }

        const username = localStorage.getItem("mindspace_username");
        console.log("Welcome", username, "| Avatar:", avatar);
      });
    </script>
  </body>
</html>
